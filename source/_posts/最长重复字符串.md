#### 最长重复子串

二分+字符串哈希，要记住[二分的模版](https://irgb1900.blogspot.com/2020/02/lowerbound-upperbound-binarysearch_24.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed:+Irgb+(irgb)&m=1)

理解[字符串哈希的原理](https://oi-wiki.org/string/hash/)


```c++

#define MAXN 31000

typedef unsigned long long ll;


class Solution {
public:
    string longestDupSubstring(string s) {
        if(s.size()==0) return "";
        ll h[MAXN]{0},p[MAXN]{1};
        ll n = s.size();
        ll P=131;
        for(int i=1;i<=n;i++){
            h[i] = h[i-1] *P + (s[i-1]-'a');
            p[i] = p[i-1]*P;
        }
        int l=1,r=n;
        string ans="";
        while(r>l){
            int mid = l+(r-l)/2;
            int idx = check(s,h,p,P,mid);
            //cout<<mid<<" "<<dup<<endl;
            if(idx){
                l = mid+1;
                ans = s.substr(idx-1,mid);
            }else{
                r = mid;
            }
        }
        return ans;
    }

    int check(string& s,ll h[],ll p[],ll P,int l){
        int n = s.size();
        unordered_set<ll> st;
        for(int i=0;i+l-1<n;i++){
            ll hash = h[i+l]-h[i]*p[l];
            // cout<<"h[i]:"<<h[i]<<",h[i+l]:"<<h[i+l]<<",p[l]:"<<p[i]<<endl;
            // cout<<"i:"<<i<<","<<s.substr(i,l)<<" hash:"<<hash<<endl;
            if(st.count(hash)){
                return i+1;
            }
            st.insert(hash);
        }
        return 0;
    }

};
```